# this creates the new image to build
puppet_run_type: apply
nodes:
  - mysql:
      create:
        options:
          keyname: dans_keys
          # EBS backed 32 bit oneiric in us-west-2
          image: ami-8226abb2
          region: us-west-2
          type: m1.small
          group: accessible
      install:
        git_repos:
          git://github.com/puppetlabs/mysql: /etc/puppet/modules/mysql
        manifest: /etc/puppet/modules/swift/examples/all.pp
        options:
          keyfile: ~/.ssh/dans_keys.pem
          login: ubuntu
      test:
        command: ruby /etc/puppet/modules/swift/ext/swift.rb
        options:
          keyfile: ~/.ssh/dans_keys.pem
          login: ubuntu
